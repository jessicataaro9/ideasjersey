!function(t,a){(WC_PAO=a.WC_PAO||{}).initialized_forms=[],WC_PAO.Helper={escapeHtml:function(t){return document.createElement("div").appendChild(document.createTextNode(t)).parentNode.innerHTML},isGroupedSubsSelected:function(){var a=t(".product-type-grouped"),i=!1;return a.length&&a.find(".group_table tr.product").each(function(){if(0<t(this).find(".input-text.qty").val()&&t(this).find(".entry-summary .subscription-details").length)return i=!0,!1}),i},isGroupedMixedProductType:function(){var a=t(".product-type-grouped"),i=0,e=0;return!!a.length&&(a.find(".group_table tr.product").each(function(){0<t(this).find(".input-text.qty").val()&&(t(this).find(".entry-summary .subscription-details").length?i++:e++)}),!!(0<i)&&!!(0<e))},delay:function(t,a){var i=0;clearTimeout(i),i=setTimeout(t,a)}},WC_PAO.Form=function(){function i(a){return this instanceof i?!!a.length&&((this.$el=a,this.$addons=this.$el.find(".wc-pao-addon-field"),this.$addons.length)?void(this.is_rtl="rtl"===document.documentElement.dir,this.validation=new o(this),this.totals=new e(this),this.show_incomplete_subtotals=this.totals.showIncompleteSubtotals(),this.setupEvents(),this.validation.validate(),this.updateTotals(),t(".wc-pao-addon-image-swatch").tipTip({delay:200}),WC_PAO.initialized_forms.push(this)):(this.$addons=!1,!1)):new i(a)}function e(a){return this instanceof e?!t.isEmptyObject(a)&&(this.$form=a.$el,this.$addons=a.$addons,this.$variation_input=!!this.$form.hasClass("variations_form")&&this.$form.find('input[name="variation_id"], input.variation_id'),this.is_variable=this.$variation_input&&this.$variation_input.length>0,this.$totals=this.$form.find("#product-addons-total"),this.product_id=this.is_variable?this.$variation_input.val():this.$totals.data("product-id"),!!this.product_id&&void(this.base_price=this.$totals.data("price"),this.raw_price=this.$totals.data("raw-price"),this.product_type=this.$totals.data("type"),this.qty=parseFloat(this.$form.find("input.qty").val()),this.addons_price_data=[],this.$subscription_plans=this.$form.find(".wcsatt-options-product"),this.has_subscription_plans=this.$subscription_plans.length>0,this.is_rtl=a.is_rtl,this.total=0,this.total_raw=0,this.show_subtotal_panel=!0)):new e(a)}function o(t){return this instanceof o?!!t.$addons.length&&void(this.$form=t.$el,this.$addons=t.$addons,this.validationState=this.getInitialState()):new o(t)}return i.prototype.setupEvents=function(){var a=this;a.$el.find('button[type="submit"]').on("click",function(){if(a.validation.validate(!0))return!0;var t=a.$el.find(".wc-pao-validation-notice");if(t.length>0){var i=a.$el.find(t[0].closest(".wc-pao-addon-container"));i.length>0&&!a.is_in_viewport(i)&&i[0].scrollIntoView()}return!1}),a.$el.on("blur change",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, .wc-pao-addon-custom-text",function(){a.validation.validateAddon(t(this),!0),a.updateTotals()}),a.$el.on("keyup",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon-custom-text",function(){var i=t(this);WC_PAO.Helper.delay(function(){a.validation.validateAddon(i,!0),a.updateTotals()},300)}),a.$el.on("change","input.qty",function(){a.updateTotals()}),a.$el.on("click touchend",".wc-pao-addon-image-swatch",function(i){i.preventDefault();var e=t(this).data("value"),o=t(this).parents(".wc-pao-addon-wrap"),n=t.parseHTML(t(this).data("price")),s=o.find(".wc-pao-addon-image-swatch-selected-swatch");s.html(""),o.find(".wc-pao-addon-image-swatch").removeClass("selected"),t(this).addClass("selected"),o.find(".wc-pao-addon-image-swatch-select").val(e),s.html(n),a.validation.validateAddon(o.find("select.wc-pao-addon-field"),!0),a.updateTotals()}),a.$el.on("click",".reset_variations",function(){a.totals.reset()}),a.$el.on("wc_variation_form",function(){a.validation.validate(),a.updateTotals()}),a.$el.on("found_variation",function(t,i){a.totals.updateVariation(i),a.validation.validate(),a.updateTotals()}),a.$el.on("hide_variation",function(t){a.updateTotals()}),a.$el.on("woocommerce-product-addons-update",function(){a.validation.validate(),a.updateTotals()}),t("#credit_called").on("keyup",function(){a.validation.validate(),a.updateTotals()})},i.prototype.updateTotals=function(){this.totals.calculate(),this.show_incomplete_subtotals||this.isValid()?this.totals.render():this.totals.reset()},i.prototype.isValid=function(){var a=!0;return this.$el.find("button.single_add_to_cart_button").is(".disabled")?a=!1:(t.each(this.validation.getValidationState(),function(){if(!this.validity)return a=!1,!1}),a)},i.prototype.is_in_viewport=function(i,e,o,n){var s=t(a);if(!(i.length<1)){var r=i.length>1?i.eq(0):i,d=r.get(0),l=s.width(),c=s.height(),p=!0!==o||d.offsetWidth*d.offsetHeight;if(n=n||"vertical","function"==typeof d.getBoundingClientRect){var u=d.getBoundingClientRect(),h=u.top>=0&&u.top<c,f=u.bottom>0&&u.bottom<=c,v=u.top<0&&u.bottom>c,m=u.left>=0&&u.left<l,y=u.right>0&&u.right<=l,g=e?h||f||v:h&&f,w=e?m||y:m&&y;if("both"===n)return p&&g&&w;if("vertical"===n)return p&&g;if("horizontal"===n)return p&&w}else{var b=s.scrollTop(),$=b+c,_=s.scrollLeft(),x=_+l,q=r.offset(),k=q.top,S=k+r.height(),M=q.left,T=M+r.width(),C=!0===e?S:k,H=!0===e?k:S,A=!0===e?T:M,E=!0===e?M:T;if("both"===n)return!!p&&H<=$&&C>=b&&E<=x&&A>=_;if("vertical"===n)return!!p&&H<=$&&C>=b;if("horizontal"===n)return!!p&&E<=x&&A>=_}}},e.prototype.showIncompleteSubtotals=function(){return 1===this.$totals.data("show-incomplete-sub-total")},e.prototype.updateVariation=function(a){this.$variation_input=!!this.$form.hasClass("variations_form")&&this.$form.find('input[name="variation_id"], input.variation_id'),this.product_id=a.variation_id,this.$totals.data("product-id",this.product_id),void 0!==a.display_price?this.base_price=a.display_price:t(a.price_html).find(".amount").last().length&&(this.base_price=t(a.price_html).find(".amount").last().text(),this.base_price=this.base_price.replace(woocommerce_addons_params.currency_format_symbol,""),this.base_price=this.base_price.replace(woocommerce_addons_params.currency_format_thousand_sep,""),this.base_price=this.base_price.replace(woocommerce_addons_params.currency_format_decimal_sep,"."),this.base_price=this.base_price.replace(/[^0-9\.]/g,""),this.base_price=parseFloat(this.base_price)),this.$totals.data("price",this.base_price)},e.prototype.calculate=function(){var a=this;a.qty=parseFloat(a.$form.find("input.qty").val()),a.addons_price_data=[],a.total=0,a.total_raw=0,a.base_price=a.$totals.data("price"),a.raw_price=a.$totals.data("raw-price"),a.product_id=a.is_variable?a.$variation_input.val():a.$totals.data("product-id"),""===a.base_price&&"undefined"!=typeof custom_gift_card_amount&&custom_gift_card_amount.length&&0<custom_gift_card_amount.val()&&(a.base_price=custom_gift_card_amount.val()),woocommerce_addons_params.is_bookings&&t(".wc-bookings-booking-cost").length&&(a.base_price=parseFloat(t(".wc-bookings-booking-cost").attr("data-raw-price"))),this.$addons.each(function(){if(t(this).val()){var i=t(this),e=i.parents(".wc-pao-addon"),o=e.find(".wc-pao-addon-name").length?e.find(".wc-pao-addon-name").data("addon-name"):"",n="",s=0,r=0,d=i.data("price-type"),l=!1,c={},p=!!e.find(".wc-pao-addon-name").length&&e.find(".wc-pao-addon-name").data("has-per-person-pricing"),u=!!e.find(".wc-pao-addon-name").length&&e.find(".wc-pao-addon-name").data("has-per-block-pricing");if(i.is(".wc-pao-addon-custom-price"))l=!0,s=i.val(),r=i.val(),d="quantity_based";else if(i.is(".wc-pao-addon-input-multiplier"))""!==i.val()&&(i.val(Math.ceil(i.val())),s=i.data("price")*i.val(),r=i.data("raw-price")*i.val());else if(i.is(".wc-pao-addon-checkbox, .wc-pao-addon-radio")){if(!i.is(":checked"))return;n=i.data("label"),s=i.data("price"),r=i.data("raw-price")}else if(i.is(".wc-pao-addon-image-swatch-select, .wc-pao-addon-select")){if(!i.find("option:selected")||""===i.find("option:selected").val())return;d=i.find("option:selected").data("price-type"),n=i.find("option:selected").data("label"),s=i.find("option:selected").data("price"),r=i.find("option:selected").data("raw-price")}else{if(!i.val())return;s=i.data("price"),r=i.data("raw-price")}if(s||(s=0),r||(r=0),("booking"===a.product_type||"accommodation-booking"===a.product_type)&&woocommerce_addons_params.is_bookings){a.qty=0;var h=0;void 0!==t("#wc_bookings_field_duration")&&0<t("#wc_bookings_field_duration").val()&&(h=t("#wc_bookings_field_duration").val()),void 0!==t("#wc-bookings-form-end-time")&&0<t("#wc-bookings-form-end-time").val()&&(h=t("#wc-bookings-form-end-time").val());var f=t("#wc_bookings_field_persons"),v=0;1===f.length?v=parseInt(v,10)+parseInt(f.val(),10):t(".wc-bookings-booking-form").find("input").each(function(){var a=this.id.match(/wc_bookings_field_persons_(\d+)/);null!=a&&t("#"+a[0]).length&&(v=parseInt(v,10)+parseInt(t("#"+a[0]).val(),10))}),0===a.qty&&t(".wc-bookings-booking-cost").length&&(a.qty=1),p&&v&&(a.qty*=v),u&&h&&(a.qty*=h)}var m=t(".wc-pao-addon-input-multiplier").val();switch(t(".e-atc-qty-button-holder .quantity input[name='quantity']").val(m),m&&(a.qty=parseInt(m)),d){case"flat_fee":c.cost=parseFloat(s),c.cost_raw=parseFloat(r);break;case"quantity_based":c.cost_pu=parseFloat(s),c.cost_raw_pu=parseFloat(r),c.cost=c.cost_pu*a.qty,c.cost_raw=c.cost_raw_pu*a.qty;break;case"percentage_based":c.cost_pct=parseFloat(s)/100,c.cost_raw_pct=parseFloat(r)/100,c.cost=parseFloat(a.base_price)*c.cost_pct*a.qty,c.cost_raw=parseFloat(a.raw_price)*c.cost_raw_pct*a.qty}if(a.total+=c.cost||0,a.total_raw+=c.cost_raw||0,void 0!==n){if("number"==typeof n||n.length)c.name=o+(n?" - "+n:"");else{var y=i.val(),g=parseInt(woocommerce_addons_params.trim_user_input_characters,10);i.is(".wc-pao-addon-file-upload")&&(y=y.replace(/^.*[\\\/]/,"")),g<y.length&&(y=y.slice(0,g)+"..."),c.name=o+" - "+WC_PAO.Helper.escapeHtml(y)}c.is_custom_price=l,c.price_type=d,a.addons_price_data.push(c)}}}),a.$totals.data("price_data",a.addons_price_data),a.$form.trigger("updated_addons")},e.prototype.render=function(){var a=this;if(!a.$totals.data("show-sub-total")){a.$totals.empty(),a.$form.trigger("updated_addons");return}if(a.qty){var i,e,o,n,s,r=a.formatMoney(a.total),d=!1;if(void 0!==a.base_price&&a.product_id&&(i=t(".wc-bookings-booking-form").length?isNaN(a.base_price)?0:parseFloat(a.base_price):parseFloat(a.base_price*a.qty),e=a.formatMoney(i+a.total)),a.has_subscription_plans){var l=a.$form.data("satt_script");if(l&&l.schemes_model.get_active_scheme_key()){var c=a.$subscription_plans.find("input:checked");c.val()&&(o=c.parent().find(".subscription-details"))}}else a.$form.parent().find(".subscription-details").length&&!a.$form.hasClass("bundle_data")&&(o=a.$form.parent().find(".subscription-details"),a.$variation_input&&a.$variation_input.length>0&&(o=a.$form.parent().find(".woocommerce-variation .subscription-details")));if(o&&o.length>0&&(n=" "+o.clone().wrap("<p>").parent().html()),"grouped"===a.product_type?n&&!WC_PAO.Helper.isGroupedMixedProductType()&&WC_PAO.Helper.isGroupedSubsSelected()&&(r+=n,e&&(e+=n)):n&&e&&(e+=n),e){var p=a.$form.find(".wc-pao-addon-container").data("product-name"),u=a.formatMoney(i),h=a.$form.find(".wc-pao-addon-container").data("product-tax-status");s=t(".wc-bookings-booking-form").length?'<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong>'+p+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+u+"</span></strong></div></li>":'<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong><span>'+(a.is_rtl?woocommerce_addons_params.quantity_symbol+a.qty:a.qty+woocommerce_addons_params.quantity_symbol)+"</span> "+p+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+u+"</span></strong></div></li>",a.addons_price_data.length&&t.each(a.addons_price_data,function(t,i){var e,o;"quantity_based"===i.price_type?(o=0===(e=i.cost)?"-":a.formatMoney(e),s=s+'<li class="wc-pao-row-quantity-based"><div class="wc-pao-col1">'+i.name+'</div><div class="wc-pao-col2"><span class="amount">'+o+"</span></div></li>"):(o=0===(e=i.cost)?"-":'<span class="amount">'+a.formatMoney(e)+"</span>",s=s+'<li><div class="wc-pao-col1"><strong>'+i.name+'</strong></div><div class="wc-pao-col2">'+o+"</div></li>"),woocommerce_addons_params.tax_enabled&&i.is_custom_price&&(d=!0)});var f="",v=void 0===a.$totals.data("i18n_sub_total")?woocommerce_addons_params.i18n_sub_total:a.$totals.data("i18n_sub_total");if(!d&&(!woocommerce_addons_params.price_display_suffix||!woocommerce_addons_params.tax_enabled)){s=s+'<li class="wc-pao-subtotal-line"><p class="price">'+v+' <span class="amount">'+e+"</span></p></li></ul></div>",a.show_subtotal_panel?a.$totals.html(s):a.$totals.html(""),a.$form.trigger("updated_addons");return}if("taxable"===h&&!d&&!1==woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}")>-1&&!1==woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}")>-1){s=s+'<li class="wc-pao-subtotal-line"><strong>'+v+' <span class="amount">'+e+"</span> "+woocommerce_addons_params.price_display_suffix+"</strong></li></ul></div>",a.show_subtotal_panel?a.$totals.html(s):a.$totals.html(""),a.$form.trigger("updated_addons");return}t.ajax({type:"POST",url:woocommerce_addons_params.ajax_url,data:{action:"wc_product_addons_calculate_tax",product_id:a.product_id,add_on_total:a.total,add_on_total_raw:a.total_raw,qty:a.qty},success:function(t){if("SUCCESS"==t.result){f='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>";var i=a.formatMoney(t.price_including_tax),o=a.formatMoney(t.price_excluding_tax);f=(f=f.replace("{price_including_tax}",'<span class="amount">'+i+"</span>")).replace("{price_excluding_tax}",'<span class="amount">'+o+"</span>"),s=s+'<li class="wc-pao-subtotal-line"><p class="price">'+v+' <span class="amount">'+(woocommerce_addons_params.display_include_tax?i:o)+"</span> "+f+" </p></li></ul></div>",a.show_subtotal_panel?a.$totals.html(s):a.$totals.html(""),a.$form.trigger("updated_addons")}else s=s+'<li class="wc-pao-subtotal-line"><p class="price">'+v+' <span class="amount">'+e+"</span></p></li></ul></div>",a.show_subtotal_panel?a.$totals.html(s):a.$totals.html(""),a.$form.trigger("updated_addons")},error:function(){s=s+'<li class="wc-pao-subtotal-line"><p class="price">'+v+' <span class="amount">'+e+"</span></p></li></ul></div>",a.show_subtotal_panel?a.$totals.html(s):a.$totals.html(""),a.$form.trigger("updated_addons")}})}else a.$totals.empty(),a.$form.trigger("updated_addons")}else a.$totals.empty(),a.$form.trigger("updated_addons")},e.prototype.reset=function(){this.$totals.empty(),this.$totals.html(""),this.$form.trigger("updated_addons")},e.prototype.formatMoney=function(t){let a=woocommerce_addons_params.currency_format_num_decimals;if(woocommerce_addons_params.trim_trailing_zeros){let i=parseFloat(t)%1==0;t=parseFloat(t),a=i?0:t.toString().split(".")[1].length}return accounting.formatMoney(t,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:a,format:woocommerce_addons_params.currency_format})},o.prototype.getInitialState=function(){var a={};return t.each(this.$addons,function(){a[t(this).attr("id")]={validity:!0,message:""}}),a},o.prototype.getValidationState=function(){return this.validationState},o.prototype.validateAddon=function(a,i=!1){var e=a.data("restrictions"),o=a.attr("id"),n=!0;return!t.isEmptyObject(e)&&("required"in e&&"yes"===e.required&&(n=this.validateRequired(a)),n&&"content"in e&&("only_letters"===e.content?n=this.validateLetters(a):"only_numbers"===e.content?n=this.validateNumbers(a):"only_letters_numbers"===e.content?n=this.validateLettersNumbers(a):"email"===e.content&&(n=this.validateEmail(a))),n&&"min"in e&&(n=this.validateMin(a,e.min)),n&&"max"in e&&(n=this.validateMax(a,e.max))),i&&this.printMessage(a),this.validationState[o].validity},o.prototype.validate=function(a=!1){var i=!0,e=this;return t.each(e.$addons,function(){e.validateAddon(t(this),a)||(i=!1)}),i},o.prototype.printMessage=function(t){var a=t.attr("id"),i=this.$form.find("#"+a),e=a+"-validation-notice",o=this.validationState[a].message;if(i.is(":radio")||i.is(":checkbox")){var n=i.closest(".wc-pao-addon-container .wc-pao-addon-wrap");n.find(".wc-pao-validation-notice").remove(),this.validationState[a].validity||n.append('<small id="'+e+'" class="wc-pao-validation-notice">'+o+"</small>")}else i.closest(".wc-pao-addon-container").find(".wc-pao-validation-notice").remove(),this.validationState[a].validity||i.after('<small id="'+e+'" class="wc-pao-validation-notice">'+o.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</small>")},o.prototype.validateRequired=function(a){var i=!0,e="",o="",n=a.attr("id");if(a.is(":checkbox")||a.is(":radio")){var s=a.closest(".wc-pao-addon-container"),r=s.find(".wc-pao-addon-field"),d=this;if(i=!1,t.each(r,function(){if(t(this).is(":checked")){i=!0;return}}),i){t.each(r,function(){var a=t(this).attr("id");d.validationState[a]={validity:i,message:e,reason:o}});return}e=woocommerce_addons_params.i18n_validation_required_select}else if(a.hasClass("wc-pao-addon-image-swatch-select")){var s=a.closest(".wc-pao-addon-container");i=!1,t.each(s.find(".wc-pao-addon-image-swatch"),function(){if(t(this).hasClass("selected")){i=!0;return}}),i||(e=woocommerce_addons_params.i18n_validation_required_select)}else!a.val()&&(i=!1,"file"===a.attr("type")?e=woocommerce_addons_params.i18n_validation_required_file:"number"===a.attr("type")?e=woocommerce_addons_params.i18n_validation_required_number:a.is("input")||a.is("textarea")?e=woocommerce_addons_params.i18n_validation_required_input:a.is("select")&&(e=woocommerce_addons_params.i18n_validation_required_select));return i||(o="required"),this.validationState[n]={validity:i,message:e,reason:o},this.validationState[n].validity},o.prototype.validateLetters=function(t){var a=!/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~\d]/g.test(t.val()),i="",e="",o=t.attr("id");return t.val()||(a=!0),a||(i=woocommerce_addons_params.i18n_validation_letters_only,e="letters"),this.validationState[o]={validity:a,message:i,reason:e},this.validationState[o].validity},o.prototype.validateNumbers=function(t){var a=/^[0-9]*$/g.test(t.val()),i="",e="",o=t.attr("id");return t.val()||(a=!0),a||(i=woocommerce_addons_params.i18n_validation_numbers_only,e="numbers"),this.validationState[o]={validity:a,message:i,reason:e},this.validationState[o].validity},o.prototype.validateLettersNumbers=function(t){var a=!/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/g.test(t.val()),i="",e="",o=t.attr("id");return t.val()||(a=!0),a||(i=woocommerce_addons_params.i18n_validation_letters_and_numbers_only,e="letters_numbers"),this.validationState[o]={validity:a,message:i,reason:e},this.validationState[o].validity},o.prototype.validateEmail=function(t){var a=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t.val()),i="",e="",o=t.attr("id");return t.val()||(a=!0),a||(i=woocommerce_addons_params.i18n_validation_email_only,e="email"),this.validationState[o]={validity:a,message:i,reason:e},this.validationState[o].validity},o.prototype.validateMin=function(t,a){var i=!0,e="",o="",n=t.attr("id");if(t.val()){if("number"===t.attr("type")){var s=t.val();(s=s.includes(".")||s.includes(",")?parseFloat(s):parseInt(s))<a&&(i=!1,e=woocommerce_addons_params.i18n_validation_min_number.replace("%c",a))}else("text"===t.attr("type")||t.is("textarea"))&&t.val().length<a&&(i=!1,e=woocommerce_addons_params.i18n_validation_min_characters.replace("%c",a))}else i=!0;return i||(o="min"),this.validationState[n]={validity:i,message:e,reason:o},this.validationState[n].validity},o.prototype.validateMax=function(t,a){var i=!0,e="",o=o,n=t.attr("id");if(t.val()){if("number"===t.attr("type")){var s=t.val();(s=s.includes(".")||s.includes(",")?parseFloat(s):parseInt(s))>a&&(i=!1,e=woocommerce_addons_params.i18n_validation_max_number.replace("%c",a))}else("text"===t.attr("type")||t.is("textarea"))&&t.val().length>a&&(i=!1,e=woocommerce_addons_params.i18n_validation_max_characters.replace("%c",a))}else i=!0;return i||(o="max"),this.validationState[n]={validity:i,message:e,reason:o},this.validationState[n].validity},i}(),t(function(){t("body").on("quick-view-displayed",function(){t(this).find(".cart:not(.cart_group)").each(function(){new WC_PAO.Form(t(this))})}),t("body").find(".cart:not(.cart_group)").each(function(){new WC_PAO.Form(t(this))})})}(jQuery,window);